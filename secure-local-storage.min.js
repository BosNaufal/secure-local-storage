/*! Copyright (c) 2016 Naufal Rabbani (https://github.com/BosNaufal)
* Licensed Under MIT (http://opensource.org/licenses/MIT)
*
* Secure Local Storage - Version 1.0.0
*
*/
(function(g){function t(){return k("decrypt",g.__SECURE_LOCAL_STORAGE_PASS__,c[this.num2]+"secureStorageInternalPassword"+c[this.num1])}function m(a,c){for(var b=Object.keys(a),d=c?"decrypt":"encrypt",f=t.call(this.config),e={},n=0;n<b.length;n++){var q=b[n];e[k(d,q,f)]=k(d,a[q],f)}return e}g=this;var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),k=function(a,h,b){var d=b.split("");h=h.split("");var f=0;for(b=0;b<d.length;b++)for(var e=0;e<c.length;e++)d[b]==c[e]&&(f+=
e);if("encrypt"==a){a=function(a){for(var b=0;b<c.length;b++)if(a==c[b]){var d=function(a){return a>c.length?(a-=c.length,d(a)):a};return c[d(b+f)]}return a};d=[];for(b=0;b<h.length;b++)e=a(h[b]),d.push(e);return d.join("")}if("decrypt"==a){a=function(a){for(var b=0;b<c.length;b++)if(a==c[b]){var d=function(a){return 0>a?(a+=c.length,d(a)):a};return c[d(b-f)]}return a};d=[];for(b=0;b<h.length;b++)e=a(h[b]),d.push(e);return d.join("")}},r=function(){g.__SECURE_LOCAL_STORAGE_PASS__="";var a=window.localStorage.getItem("secureLocalStorageNums");
null===a?(this.num1=Math.floor(5*Math.random()),this.num2=Math.floor(7*Math.random())):(this.num1=parseFloat(a.substr(0,1)),this.num2=parseFloat(a.substr(1,1)))};r.prototype.setPassword=function(a){a=k("encrypt",a,c[this.num2]+"secureStorageInternalPassword"+c[this.num1]);g.__SECURE_LOCAL_STORAGE_PASS__=a;window.localStorage.setItem("secureLocalStorageNums",this.num1.toString()+this.num1.toString())};var l=function(){this.config=new r;this.all={};null!==window.localStorage.getItem("secureLocalStorage")&&
(this.all=JSON.parse(decodeURIComponent(window.localStorage.getItem("secureLocalStorage"))));return this};l.prototype.setPassword=function(a){this.config.setPassword(a)};l.prototype.set=function(a,c){if(""===g.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var b={};"string"===typeof a&&(b={},b[a]=c,b=m.call(this.secureStorage,b));"object"===typeof a&&(b=m.call(this.secureStorage,a));for(var d=Object.keys(b),f=0;f<d.length;f++){var e=d[f];
this.all[e]=b[e]}return window.localStorage.setItem("secureLocalStorage",encodeURIComponent(JSON.stringify(this.all)))};l.prototype.get=function(a){if(null===window.localStorage.getItem("secureLocalStorage"))return console.warn("[Secure Local Storage]: Your storage Is Empty!"),!1;if(""===g.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var c=JSON.parse(decodeURIComponent(window.localStorage.getItem("secureLocalStorage")));return m.call(this.secureStorage,
c,!0)[a]};l.prototype.remove=function(a){if(null===window.localStorage.getItem("secureLocalStorage"))return console.warn("[Secure Local Storage]: Your storage Is Empty!"),!1;if(""===g.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var h=k("decrypt",g.__SECURE_LOCAL_STORAGE_PASS__,c[this.config.num2]+"secureStorageInternalPassword"+c[this.config.num1]);a=k("encrypt",a,h);delete this.all[a];return window.localStorage.setItem("secureLocalStorage",
encodeURIComponent(JSON.stringify(this.all)))};l.prototype.reset=function(){this.all={};window.localStorage.removeItem("secureLocalStorageNums");return window.localStorage.removeItem("secureLocalStorage")};var p=new l;"object"===typeof module&&module.exports?module.exports=p:"function"===typeof define&&define.amd?define(function(){return p}):void 0!==typeof window&&(window.secureStorage=p)})(this);
