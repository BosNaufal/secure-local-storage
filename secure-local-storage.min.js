/*! Copyright (c) 2016 Naufal Rabbani (https://github.com/BosNaufal)
* Licensed Under MIT (http://opensource.org/licenses/MIT)
*
* Secure Local Storage - Version 1.0.0
*
*/
!function(e){function t(){var t=n("decrypt",e.__SECURE_LOCAL_STORAGE_PASS__,o[this.num2]+"secureStorageInternalPassword"+o[this.num1]);return t}function r(e,r){for(var o=Object.keys(e),a=this,s=r?"decrypt":"encrypt",c=t.call(a.config),l={},u=0;u<o.length;u++){var i=o[u];l[n(s,i,c)]=n(s,e[i],c)}return l}var e=this,o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],n=function(e,t,r){for(var n=r.split(""),a=t.split(""),s=0,c=0;c<n.length;c++)for(var l=0;l<o.length;l++)n[c]==o[l]&&(s+=l);if("encrypt"==e){for(var u=function(e){for(var t=0;t<o.length;t++)if(e==o[t]){var r=function(e){return e>o.length?(e-=o.length,r(e)):e};return o[r(t+s)]}return e},i=[],c=0;c<a.length;c++){var S=u(a[c]);i.push(S)}return i.join("")}if("decrypt"==e){for(var g=function(e){for(var t=0;t<o.length;t++)if(e==o[t]){var r=function(e){return 0>e?(e+=o.length,r(e)):e};return o[r(t-s)]}return e},f=[],c=0;c<a.length;c++){var _=g(a[c]);f.push(_)}return f.join("")}},a=function(){e.__SECURE_LOCAL_STORAGE_PASS__="";var t=window.localStorage.getItem("secureLocalStorageNums");null===t?(this.num1=Math.floor(5*Math.random()),this.num2=Math.floor(7*Math.random())):(this.num1=parseFloat(t.substr(0,1)),this.num2=parseFloat(t.substr(1,1)))};a.prototype.setPassword=function(t){var t=n("encrypt",t,o[this.num2]+"secureStorageInternalPassword"+o[this.num1]);e.__SECURE_LOCAL_STORAGE_PASS__=t,window.localStorage.setItem("secureLocalStorageNums",this.num1.toString()+this.num1.toString())};var s=function(){return this.config=new a,this.all={},null!==window.localStorage.getItem("secureLocalStorage")&&(this.all=JSON.parse(decodeURIComponent(window.localStorage.getItem("secureLocalStorage")))),this};s.prototype.setPassword=function(e){this.config.setPassword(e)},s.prototype.set=function(t,o){var n=this;if(""===e.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var a={};if("string"==typeof t){var s={};s[t]=o,a=r.call(n.secureStorage,s)}"object"==typeof t&&(a=r.call(n.secureStorage,t));for(var c=Object.keys(a),l=0;l<c.length;l++){var u=c[l];n.all[u]=a[u]}return window.localStorage.setItem("secureLocalStorage",encodeURIComponent(JSON.stringify(n.all)))},s.prototype.get=function(t){var o=this;if(null===window.localStorage.getItem("secureLocalStorage"))return console.warn("[Secure Local Storage]: Your storage Is Empty!"),!1;if(""===e.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var n=JSON.parse(decodeURIComponent(window.localStorage.getItem("secureLocalStorage"))),a=r.call(o.secureStorage,n,!0);return a[t]},s.prototype.remove=function(t){function r(){var t=n("decrypt",e.__SECURE_LOCAL_STORAGE_PASS__,o[a.config.num2]+"secureStorageInternalPassword"+o[a.config.num1]);return t}var a=this;if(null===window.localStorage.getItem("secureLocalStorage"))return console.warn("[Secure Local Storage]: Your storage Is Empty!"),!1;if(""===e.__SECURE_LOCAL_STORAGE_PASS__)return console.warn("[Secure Local Storage]: You need to set the password"),!1;var s=n("encrypt",t,r());return delete a.all[s],window.localStorage.setItem("secureLocalStorage",encodeURIComponent(JSON.stringify(a.all)))},s.prototype.reset=function(){return this.all={},window.localStorage.removeItem("secureLocalStorageNums"),window.localStorage.removeItem("secureLocalStorage")};var c=new s;"object"==typeof module&&module.exports?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):void 0!==typeof window&&(window.secureStorage=c)}(this);